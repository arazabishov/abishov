@import "@fontsource/geist-mono";
@import "@fontsource/geist-sans";
@import "tailwindcss";
@plugin "@tailwindcss/typography";

/* Apply dark: styles when data-theme="dark" is present on the element or an ancestor */
@custom-variant dark (&:where([data-theme=dark], [data-theme=dark] *));

/* Colors are defined in oklch(Lightness Chroma Hue) for better perceptual uniformity and wider gamut support */
:root {
  --background: oklch(1 0 0);
  --foreground: oklch(0.145 0 0);
  --primary: oklch(0.205 0 0);
  --primary-foreground: oklch(0.985 0 0);
  --muted: oklch(0.97 0 0);
  --muted-foreground: oklch(0.556 0 0);
  --border: oklch(0.922 0 0);
  --ring: oklch(0.708 0 0);
}

/* Dark mode overrides: these values replace the :root values when the theme is dark */
[data-theme="dark"] {
  --background: oklch(0.145 0 0);
  --foreground: oklch(0.985 0 0);
  --primary: oklch(0.922 0 0);
  --primary-foreground: oklch(0.205 0 0);
  --muted: oklch(0.269 0 0);
  --muted-foreground: oklch(0.708 0 0);
  --border: oklch(1 0 0 / 10%);
  --ring: oklch(0.556 0 0);
}

@theme inline {
  /* Fallback fonts from Tailwind CSS defaults: https://tailwindcss.com/docs/font-family */
  --font-sans:
    "Geist Sans", ui-sans-serif, system-ui, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol",
    "Noto Color Emoji";
  /* Fallback fonts from Tailwind CSS defaults: https://tailwindcss.com/docs/font-family */
  --font-mono:
    "Geist Mono", ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --color-primary: var(--primary);
  --color-primary-foreground: var(--primary-foreground);
  --color-muted: var(--muted);
  --color-muted-foreground: var(--muted-foreground);
  --color-border: var(--border);
  --color-ring: var(--ring);
}

@layer base {
  *,
  ::after,
  ::before,
  ::backdrop,
  ::file-selector-button {
    @apply border-border outline-ring/50 tracking-tight;
  }

  /* Typography base styles */
  p,
  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    @apply wrap-break-word;
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    @apply text-balance;
  }

  p {
    @apply text-pretty;
  }
}

/* Override typography plugin's default colors with our theme */
@layer utilities {
  .prose {
    --tw-prose-body: var(--foreground);
    --tw-prose-headings: var(--foreground);
    --tw-prose-lead: var(--muted-foreground);
    --tw-prose-links: var(--foreground);
    --tw-prose-bold: var(--foreground);
    --tw-prose-counters: oklch(from var(--foreground) l c h / 30%);
    --tw-prose-bullets: oklch(from var(--foreground) l c h / 30%);
    --tw-prose-hr: var(--border);
    --tw-prose-quotes: var(--muted-foreground);
    --tw-prose-quote-borders: var(--border);
    --tw-prose-captions: var(--muted-foreground);
    --tw-prose-kbd: var(--foreground);
    --tw-prose-kbd-shadows: var(--foreground);
    --tw-prose-code: var(--foreground);
    --tw-prose-pre-code: var(--foreground);
    --tw-prose-pre-bg: var(--muted);
    --tw-prose-th-borders: var(--border);
    --tw-prose-td-borders: var(--border);

    /* Inline code styling */
    & :where(code):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
      @apply bg-muted/50 rounded-sm px-[0.3rem] py-[0.2rem] text-sm font-medium;
    }

    & :where(code):not(:where([class~="not-prose"], [class~="not-prose"] *))::before,
    & :where(code):not(:where([class~="not-prose"], [class~="not-prose"] *))::after {
      content: none;
    }

    /* Headings */
    & :where(h1, h2, h3, h4, h5, h6):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
      @apply scroll-mt-32 font-medium xl:scroll-mt-20;
    }

    /* Links */
    & :where(a):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
      @apply decoration-muted-foreground hover:decoration-foreground underline-offset-[3px] transition-colors;
    }

    /* Blockquotes */
    & :where(blockquote):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
      @apply border-l-2 pl-6 not-italic;
    }

    /* Images and code blocks */
    & :where(img, video, figure, .expressive-code):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
      @apply mx-auto;
    }

    /* Pre blocks */
    & :where(pre):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
      @apply max-h-[min(68vh,1000px)]! overflow-y-auto;
    }

    /* Keyboard */
    & :where(kbd):not(:where([class~="not-prose"], [class~="not-prose"] *)) {
      @apply bg-muted rounded-md border px-2 py-1 text-xs;
    }
  }
}
